================================================================================
                    FORENSISCHE NETFLOW-ANALYSE - SICHERHEITSBERICHT
================================================================================

Netflow-ID:        74
Analysedatum:      24. Januar 2026
Analyst:           Automatisiertes NIDS-Validierungssystem

================================================================================
                         [KLASSIFIZIERUNG: BESTÄTIGT]
================================================================================

Die vom Network Intrusion Detection System (NIDS) vorgenommene Klassifizierung
als bösartiger Netzwerkverkehr wird hiermit BESTÄTIGT.

Angriffstyp:       FTP BRUTE-FORCE-ANGRIFF
Bedrohungsstufe:   HOCH
Konfidenz:         95%

================================================================================
                              BEWEISFÜHRUNG
================================================================================

Die Analyse basiert auf folgenden konkreten Beweisen aus den NetFlow-Daten:

1. ZIELPORT-ANALYSE
   ─────────────────────────────────────────────────────────────────────────
   Beobachteter Wert:    L4_DST_PORT = 21 (FTP-Steuerkanal)
   Bewertung:            Port 21 ist der Standard-Port für FTP-Verbindungen
                         und ein häufiges Ziel für Brute-Force-Angriffe.

2. PROTOKOLL-IDENTIFIKATION
   ─────────────────────────────────────────────────────────────────────────
   PROTOCOL:             6 (TCP - Transmission Control Protocol)
   L7_PROTO:             1.0 (FTP-Anwendungsprotokoll)
   Bewertung:            Die Protokollkombination bestätigt legitime
                         FTP-Kommunikation auf Anwendungsebene.

3. PAKETMUSTER-ANALYSE
   ─────────────────────────────────────────────────────────────────────────
   IN_PKTS:              13 Pakete (Client → Server)
   OUT_PKTS:             13 Pakete (Server → Client)
   NUM_PKTS_UP_TO_128:   26 Pakete (100% kleine Pakete)
   
   Bewertung:            Das symmetrische Paketverhältnis und die 
                         ausschließliche Verwendung kleiner Pakete (≤128 Bytes)
                         entspricht dem typischen Muster eines FTP-Login-
                         Versuchs. Die Paketanzahl (13) liegt im charakteris-
                         tischen Bereich für Brute-Force-Versuche (11-51 PKTS).

4. DATENVOLUMEN-ANALYSE
   ─────────────────────────────────────────────────────────────────────────
   IN_BYTES:             780 Bytes (Client → Server)
   OUT_BYTES:            520 Bytes (Server → Client)
   Paketgröße:           40-60 Bytes (MIN/MAX_IP_PKT_LEN)
   
   Bewertung:            Das geringe Datenvolumen mit kleinen Paketen ist
                         typisch für Authentifizierungsversuche, bei denen
                         nur Benutzername und Passwort übertragen werden.

5. FLOW-DAUER UND TIMING
   ─────────────────────────────────────────────────────────────────────────
   FLOW_DURATION:        4.294.763 ms (~71 Minuten)
   DURATION_IN/OUT:      204 ms (tatsächliche Aktivitätsdauer)
   
   Bewertung:            Die kurze tatsächliche Aktivitätsdauer (204 ms) bei
                         langer Gesamtdauer deutet auf automatisierte
                         Verbindungsversuche mit Wartezeiten hin - ein
                         typisches Muster für Brute-Force-Tools.

6. TCP-FLAGS-ANALYSE
   ─────────────────────────────────────────────────────────────────────────
   TCP_FLAGS:            22 (SYN + RST + ACK kombiniert)
   CLIENT_TCP_FLAGS:     2 (SYN)
   SERVER_TCP_FLAGS:     20 (RST + ACK)
   
   Bewertung:            Der Client initiiert mit SYN, der Server antwortet
                         mit RST+ACK. Dies deutet auf abgelehnte Verbindungen
                         oder fehlgeschlagene Authentifizierung hin.

7. BEDROHUNGSINTELLIGENZ
   ─────────────────────────────────────────────────────────────────────────
   Quell-IP (18.221.219.4):
     - Standort:         Dublin, Ohio, USA
     - ISP:              Amazon Web Services (AWS)
     - AS:               AS16509 Amazon.com, Inc.
     - Bekannte Aktivität: FTP-BruteForce
   
   Ziel-IP (172.31.69.25):
     - Typ:              Private/Interne IP-Adresse (RFC 1918)
     - Frühere Angriffe: DoS-Hulk, DDoS-LOIC-HTTP, SSH-Bruteforce,
                         DoS-GoldenEye, FTP-BruteForce, DoS-SlowHTTPTest,
                         DoS-Slowloris
   
   Bewertung:            Die Quell-IP ist bereits für FTP-Brute-Force-
                         Angriffe bekannt. Die Ziel-IP wurde bereits
                         mehrfach Opfer verschiedener Angriffsarten.

8. HISTORISCHE KOMMUNIKATIONSANALYSE
   ─────────────────────────────────────────────────────────────────────────
   Gefundene Flows:      25.933 Einträge zwischen diesen IP-Adressen
   
   Beobachtete Muster in historischen Flows:
   - Konstanter Zielport 21 (FTP)
   - Wechselnde Quellports (35732, 41192, 55148, 44950, 37972, 59642...)
   - Identische Paketgrößen (780-840 IN_BYTES, 520-560 OUT_BYTES)
   - Identische TCP-Flag-Muster
   - Identische TTL-Werte (63)
   
   Bewertung:            Die extrem hohe Anzahl von über 25.000 ähnlichen
                         Verbindungsversuchen von derselben Quelle mit
                         wechselnden Quellports ist ein eindeutiges
                         Indiz für einen automatisierten Brute-Force-Angriff.

================================================================================
                       KATEGORISIERUNG DER BEDROHUNG
================================================================================

Primäre Klassifikation:    FTP Brute-Force-Angriff
Sekundäre Klassifikation:  Credential-Stuffing / Password-Guessing
MITRE ATT&CK Taktik:       Credential Access (TA0006)
MITRE ATT&CK Technik:      Brute Force (T1110)

Beschreibung:
─────────────────────────────────────────────────────────────────────────────
Ein FTP Brute-Force-Angriff ist ein automatisierter Versuch, sich durch
systematisches Ausprobieren von Benutzername-Passwort-Kombinationen Zugang
zu einem FTP-Server zu verschaffen. Der Angreifer nutzt dabei Cloud-
Infrastruktur (AWS), um die Rückverfolgung zu erschweren und IP-basierte
Sperren zu umgehen.

Übereinstimmende Angriffssignatur-Indikatoren:
─────────────────────────────────────────────────────────────────────────────
[✓] L4_DST_PORT 21 mit hoher Flow-Anzahl (25.933 Flows)
[✓] Paketanzahl im typischen Bereich (11-51 PKTS): 13 Pakete
[✓] Kurze DURATION bei langen Flows
[✓] Eine SRC-IP zu FTP-Server
[✓] L7_PROTO FTP (1.0)
[✓] Hoher NUM_PKTS_UP_TO_128_BYTES (26 von 26 Paketen)
[○] FTP_COMMAND_RET_CODE 530 nicht beobachtet (Wert: 0)

================================================================================
                            RISIKOBEWERTUNG
================================================================================

Risikostufe:           HOCH

Auswirkungen bei Erfolg:
─────────────────────────────────────────────────────────────────────────────
• Unbefugter Zugriff auf Dateisysteme
• Datenexfiltration sensibler Informationen
• Installation von Malware oder Backdoors
• Laterale Bewegung im Netzwerk
• Missbrauch als Staging-Server für weitere Angriffe

Wahrscheinlichkeit:    ERHÖHT
Begründung:            Die persistente Natur des Angriffs (>25.000 Versuche)
                       und die Nutzung von Cloud-Infrastruktur deuten auf
                       einen motivierten Angreifer mit Ressourcen hin.

================================================================================
                       EMPFOHLENE GEGENMASSNAHMEN
================================================================================

SOFORT (Priorität 1):
─────────────────────────────────────────────────────────────────────────────
1. IP-BLOCKIERUNG
   → Sofortige Sperrung der IP 18.221.219.4 an der Perimeter-Firewall
   → Implementierung von Geo-Blocking für AWS-IP-Bereiche falls nicht
     geschäftlich erforderlich

2. KONTOSICHERHEIT
   → Überprüfung aller FTP-Konten auf kompromittierte Zugangsdaten
   → Erzwungene Passwortänderung für alle FTP-Benutzer
   → Deaktivierung ungenutzter FTP-Konten

KURZFRISTIG (Priorität 2):
─────────────────────────────────────────────────────────────────────────────
3. RATE-LIMITING
   → Implementierung von Verbindungslimits pro IP (max. 5/Minute)
   → Aktivierung von Fail2Ban oder äquivalentem IPS für FTP

4. MONITORING
   → Erhöhte Überwachung des FTP-Dienstes
   → Alarmierung bei mehr als 10 fehlgeschlagenen Logins pro Minute

5. PROTOKOLLSICHERHEIT
   → Migration von FTP zu SFTP oder FTPS
   → Deaktivierung von anonymem FTP-Zugang

LANGFRISTIG (Priorität 3):
─────────────────────────────────────────────────────────────────────────────
6. AUTHENTIFIZIERUNG
   → Implementierung von Multi-Faktor-Authentifizierung (MFA)
   → Zertifikatsbasierte Authentifizierung erwägen

7. NETZWERKSEGMENTIERUNG
   → FTP-Server in separate DMZ verschieben
   → Zugriff nur über VPN ermöglichen

8. ALTERNATIVE LÖSUNGEN
   → Evaluierung sicherer Dateitransfer-Alternativen (SFTP, SCP, HTTPS)

================================================================================
                                 FAZIT
================================================================================

Die forensische Analyse bestätigt eindeutig die NIDS-Klassifizierung als
bösartigen Netzwerkverkehr. Der analysierte NetFlow-Eintrag (ID: 74) ist
Teil eines groß angelegten FTP Brute-Force-Angriffs von einer AWS-gehosteten
IP-Adresse (18.221.219.4) gegen einen internen Server (172.31.69.25).

Die Bewertung stützt sich auf:
• Bekannte Bedrohungsintelligenz zur Quell-IP
• Charakteristische Angriffssignaturen im Datenverkehr
• Massive Anzahl ähnlicher Verbindungsversuche (>25.000)
• Typische Paket- und Timing-Muster für Brute-Force-Aktivitäten

Es wird dringend empfohlen, die vorgeschlagenen Gegenmaßnahmen umgehend
umzusetzen, um die Sicherheit des betroffenen Systems zu gewährleisten.

================================================================================
                     ANALYSIERTE ROHDATEN (ORIGINAL)
================================================================================

netflow_id: 74
IPV4_SRC_ADDR: 18.221.219.4
L4_SRC_PORT: 35732
IPV4_DST_ADDR: 172.31.69.25
L4_DST_PORT: 21
PROTOCOL: 6
L7_PROTO: 1.0
IN_BYTES: 780
IN_PKTS: 13
OUT_BYTES: 520
OUT_PKTS: 13
TCP_FLAGS: 22
CLIENT_TCP_FLAGS: 2
SERVER_TCP_FLAGS: 20
FLOW_DURATION_MILLISECONDS: 4294763
DURATION_IN: 204
DURATION_OUT: 204
MIN_TTL: 63
MAX_TTL: 63
LONGEST_FLOW_PKT: 60
SHORTEST_FLOW_PKT: 40
MIN_IP_PKT_LEN: 40
MAX_IP_PKT_LEN: 60
SRC_TO_DST_SECOND_BYTES: 780.0
DST_TO_SRC_SECOND_BYTES: 520.0
RETRANSMITTED_IN_BYTES: 0
RETRANSMITTED_IN_PKTS: 0
RETRANSMITTED_OUT_BYTES: 0
RETRANSMITTED_OUT_PKTS: 0
SRC_TO_DST_AVG_THROUGHPUT: 24000
DST_TO_SRC_AVG_THROUGHPUT: 16000
NUM_PKTS_UP_TO_128_BYTES: 26
NUM_PKTS_128_TO_256_BYTES: 0
NUM_PKTS_256_TO_512_BYTES: 0
NUM_PKTS_512_TO_1024_BYTES: 0
NUM_PKTS_1024_TO_1514_BYTES: 0
TCP_WIN_MAX_IN: 26883
TCP_WIN_MAX_OUT: 0
ICMP_TYPE: 0
ICMP_IPV4_TYPE: 0
DNS_QUERY_ID: 0
DNS_QUERY_TYPE: 0
DNS_TTL_ANSWER: 0
FTP_COMMAND_RET_CODE: 0

================================================================================
                            ENDE DES BERICHTS
================================================================================

Erstellt von: Forensisches NIDS-Validierungssystem
Berichtsdatum: 24. Januar 2026
Dokumentversion: 1.0
